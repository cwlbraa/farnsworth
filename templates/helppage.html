{% extends "base.html" %}

{% load static from staticfiles %}

{% block headers %}
<link type="text/css" rel="stylesheet" href="{% static 'ui/css/content.css' %}" />
<link type="text/css" rel="stylesheet" href="{% static 'ui/css/helppage.css' %}" />
{% endblock %}

{% block title %}
{% if not user.is_authenticated %}
<div id="title">
	<h1 id="page_title" class="hidden-xs">Welcome to {{ HOUSE }}</h1>
	<h1 class="visible-xs sub_title" style="margin: 0;">{{ HOUSE }}</h1>
	<br />
</div> <!-- close "title" -->
{% endif %}
{% endblock %}

{% block content %}
{% if not user.is_authenticated %}
	<p>Welcome!  This is a virtual gathering place for members of {{ HOUSE }} as well as a community outreach and general information site.
	</p>
	<p>If you are a new member, you can request an account by clicking <a href="{% url 'request_profile' %}">here</a> or on the request profile link
	in the menu above.  Once your request is submitted, an admin will contact you.
	</p>
	<p>If you are currently a member, please login to access member forums, manager requests, event postings, and announcements.
	</p>
{% else %}
	{% if user.is_superuser %}
	<div class="row">
	<div id="managing_users" class="col-md-6">
		<h1 class="sub_title text-center">Admin: Managing Users <small><a name="managing_users" title="A link to this section" href="#managing_users">&sect;</a></small></h1>
		<div class="text-center"><a class="toggle_div">show/hide</a></div>
		<div id="managing_users_body" class="toggleable">
		<hr style="width: 75%;" />
		<h2 class="sub_subtitle">Adding Users <a name="adding_users" title="A link to this sub-section" href="#adding_users">&sect;</a></h2>
			<p>You can add a user from the <a target="_blank" href="{% url 'custom_add_user' %}">add user page</a>.  The process is fairly intuitive.
			Usernames should be unique.  It is recommended that e-mails and phone numbers be kept hidden from other members when creating a user.
			A user can modify her/his own profile to reveal e-mail and phone number to other members.
			</p>
			<p>The "is active" status is an indicator of whether the user can login.  You can add inactive users, but you will probably be adding active users.
			Starting alumni as inactive users is advised, as this will result in a tighter security spec for your implementation of Farnsworth.
			Doing so is permissible as alumni are not very likely to log in.  And if an alumnus does want to, s/he can e-mail you (via the e-mail listed at the
			bottom of this page to get her/his account activated.
			When an inactive user attempts to login, s/he is given a message saying her/his account is inactive.
			</p>
			<p>The "is staff" status indicates whether a user can access the <a target="_blank" href="{% url 'admin:index' %}">Django admin pages</a>.
			Use of the Django admin pages is discouraged.  If something really needs to be done at that level,
			it would be better if you wrote the page up yourself in the regular interface
			and shared it with everyone else using Farnsworth.  Writing pages is very easy.  Read the documentation at Karandeep's
			<a target="_blank" href="https://www.github.com/knagra/farnsworth/">GitHub repo</a> or contact him directly
			(e-mail: <a href="mailto:karandeepsnagra@gmail.com">karandeepsnagra@gmail.com</a>) for some quick tips.
			</p>
			<p>However, even if a user has staff status, s/he will not have any privileges without a superuser giving her/him those rights.
			This can be done from the Django admin pages.  Read the <a target="_blank" href="https://docs.djangoproject.com/">Django docs</a> to learn more.
			</p>
			<p>The "is superuser" status toggles admin rights on the site.
			A user with superuser privileges will able to access admin pages written into this interface and have full privileges in the Django admin.
			</p>
			<p>Groups are fully supported by Django but are not yet supported by the custom Farnsworth interface.
			They are provided in this page in case someone wants to do further development of Django which involves groups.
			You can CTRL-click and select multiple groups from this list.
			</p>
			<p><b>You must provide a password.</b>  An option is not yet available to create users without passwords.
			This would be a neat feature if you care to implement it yourself.  If you want to create a user that will probably not use the site for a while
			(alumni, for example), it is recommended that you toggle off the "is active" option for the user.  You can toggle it back on later by modifying
			the user when the user wants access to the site.
			</p>
		<h2 class="sub_subtitle">Modifying Users <a name="modifying_users" title="A link to this sub-section" href="#modify_users">&sect;</a></h2>
			<p>A list of all users can be seen at the <a target="_blank" href="{% url 'custom_manage_users' %}">manage users page</a>.
			This page will give you a quick run-down of users, their e-mail addresses, phone numbers, and active, staff and superuser statuses.
			The tables are sortable.  You can click on any heading to sort the table by that column.
			You can also hold shift and click multiple column headings to sort by all those columns successively.
			By default, the tables are sorted by last name and then first name.
			Clicking on an e-mail address will prompt you to send an e-mail to that address.
			You can click on any user's name from the manage users page to edit that user's profile.
			</p>
			<p>From the modify user page, you can change a user's personal details, member status, etc., as well as change her/his password.
			To prevent permanent lockout, if you are the only superadmin, <b>you will be prevented from changing your own superadmin status</b>.
			Everything else will be saved when you try to change your own profile as the only admin.
			</p>
			<p><b>It is highly recommended that users not be deleted.  You should instead deactivate them.</b>
			But if you really need to delete a user, you can do so from the <a target="_blank" href="{% url 'admin:index' %}">Django admin pages</a>.
			Doing so will delete all threads and requests the user posted, all messages and responses the user posted, as well as all events.
			This can mess up all manner of things.  So it's recommended that you not do it.
			</p>
			<p>You cannot modify usernames from the custom admin pages, but you can do so from the Django admin pages.
			It doesn't seem productive to allow such a change as the user who owns the account will locked out of his/her account and unable even to know
			what happened.
			</p>
			<p>You are also discouraged from modifying the anonymous user (username "{{ ANONYMOUS_USERNAME }}").
			When you open this user's edit page, a warning will be displayed saying the same.
			More on the anonymous user is covered under the <a href="#anonymous_user">Anonymous User sub-section</a> of the <a href="#admin_miscellaneous">Admin: Miscellaneous section</a>.
			</p>
			<p>On every user profile page (a general user page accessed from various parts of the site, most notably the
			<a href="{% url 'member_directory' %}">member directory</a>),
			there will appear a yellow edit button in the top right corner if an admin is accessing the page.
			This button does not appear for non-superadmin users; so you don't need to worry about that.
			Clicking this button will redirect you to the modify user page (an admin page accessed usually through the manage users page).
			</p>
			<p>The modify user page is almost identical to the <a href="{% url 'custom_add_user' %}">add user page</a>, with a few exceptions.
			First, the username, first name, and last name fields are missing.  And second, there is a separate form at the bottom to change the password.
			You can update the profile or change the password for the user, but not both in one HTTP request.
			AJAX is not currently supported.  This is another cool feature, if you care to implement it.
			</p>
		<h2 class="sub_subtitle">Profile Requests <a name="profile_requests" title="A link to this sub-section" href="#profile_requests">&sect;</a></h2>
			<p>Sometimes - especially at the beginning of the semester - you will get requests for new profiles.
			These can be managed from the <a href="{% url 'manage_profile_requests' %}">manage profile requests</a> page.
			Profile requests contain most of the information affiliated with a prospective user profile.
			You can sort this table as well, in the same way described in the <a href="#modifying_users">Modifying Users</a> sub-section above.
			You can click on the e-mail link to write an e-mail to the user or click the user's proposed username to modify the request.
			</p>
			<p>The form in the modify profile request page is almost identical to the one in the add user page
			(detailed <a href="#adding_users">above</a>), with two exceptions.
			First, the information the user provided in her/his profile request is used to fill some of the fields of the form.
			And second, there is a button next to the add user button that allows you to delete the request permanently.
			If a request is deleted, there is no way to retrieve it.  The user will have to fill another request, or you can add the user manually
			(check the <a href="#adding_users">adding users</a> section above for more info).
			</p>
		</div> <!-- #managing_users_body -->
	</div> <!-- #managing_users -->
	<div id="admin_misc" class="col-md-6">
		<h1 class="sub_title text-center">Admin: Miscellaneous <small><a name="admin_miscellaneous" title="A link to this section" href="#admin_miscellaneous">&sect;</a></small></h1>
		<div class="text-center"><a class="toggle_div">show/hide</a></div>
		<div id="admin_misc_body" class="toggleable">
		<hr style="width: 75%;" />
		<h2 class="sub_subtitle">Anonymous User <a name="anonymous_user" title="A link to this sub-section" href="#anonymous_user">&sect;</a></h2>
			<p>Farnsworth comes prepackaged with an anonymous user.  This user (and profile) is autogenerated the first time you start an anonymous session.
			The default username is {{ ANONYMOUS_USERNAME }}.  This can be changed from the settings file (/path/to/head/farnsworth/settings.py)
			<b>before starting a first anonymous session.  Don't change this setting if the anonymous user already exists.</b>
			The autogenerated user is named Anonymous Coward.  This is a bit trickier to change; contact Karandeep if you really want to change this.
			</p>
			<p>The anonymous user is intended for logins on common space machines.  Since users will want access to the site fairly quickly on common space
			machines and won't want to login and logout constantly to check minor things, the anonymous user can be used to fill the need.
			The anonymous user is prevented from up/down voting requests or RSVP-ing to events.  But the account is permitted to start threads,
			post messages, make requests, post responses, and start events.
			</p>
			<p>An anonymous session is started from the <a href="{% url 'utilities' %}">utilities</a> page.  Login on a common space machine
			and go to this page and start an anonymous session.  When the anonymous user is logged in, the profile links are disabled and replaced by
			a login link.  Users can temporarily login to assume identity.  When a logged in user logs out, the anonymous user will be logged in and
			the anonymous session will resume.  Anonymous sessions are easy to detect as the login/profile link (the second link in the menu) is red
			during an anonymous session.
			</p>
			<p><b>Logout is disabled for the anonymous user.</b>  To logout the anonymous user and end the anonymous session, login as yourself in the
			anonymous session, go to the <a href="{% url 'utilities' %}">utilities</a> page, and end the anonymous session.
			This will logout the anonymous user and end the anonymous session.
			Your session will resume.  So make sure to logout yourself if you intend to leave the computer.
			</p>
			<p>The anonymous user is also forbidden from modifying the anonymous user profile.
			An error message will be displayed if a user tries to modify the anonymous user profile from the my profile page.
			The member directory excludes the anonymous user and the profile for the anonymous user
			</p>
		</div> <!-- #admin_misc_body -->
	</div> <!-- #admin_misc -->
	</div> <!-- .row -->
	<br />
	<hr class="main_divider" />
	{% endif %}
	<div class="row">
	<div id="profile" class="col-md-6">
		<h1 class="sub_title text-center">Profile Management <small><a name="profile_management" title="A link to this section" href="#profile_management">&sect;</a></small></h1>
		<div class="text-center"><a class="toggle_div">show/hide</a></div>
		<div id="profile_body" class="toggleable">
		<hr style="width: 75%;" />
		<p>Control over your profile is handled through the <a href="{% url 'my_profile' %}">my profile page</a>.
		You can access this page from anywhere from the top menu.
		</p>
		</div> <!-- #profile_body -->
	</div> <!-- #profile -->
	<br class="visible-xs visible-sm" />
	<div id="threads" class="col-md-6">
		<h1 class="sub_title text-center">Threads <small><a name="threads" title="A link to this section" href="#threads">&sect;</a></small></h1>
		<div class="text-center"><a class="toggle_div">show/hide</a></div>
		<div id="threads_body" class="toggleable">
		<hr style="width: 75%;" />
		</div> <!-- #threads_body -->
	</div> <!-- #threads -->
	</div> <!-- .row -->
	<br />
	<div class="row">
	<div id="requests" class="col-md-6">
		<h1 class="sub_title text-center">Requests <small><a name="requests" title="A link to this section" href="#requests">&sect;</a></small></h1>
		<div class="text-center"><a class="toggle_div">show/hide</a></div>
		<div id="requests_body" class="toggleable">
		<hr style="width: 75%;" />
		</div> <!-- #requests_body -->
	</div> <!-- #requests -->
	<br class="visible-xs visible-sm" />
	<div id="announcements" class="col-md-6">
		<h1 class="sub_title text-center">Announcements <small><a name="announcements" title="A link to this section" href="#announcements">&sect;</a></small></h1>
		<div class="text-center"><a class="toggle_div">show/hide</a></div>
		<div id="announcements_body" class="toggleable">
		<hr style="width: 75%;" />
		</div> <!-- #announcements_body -->
	</div> <!-- #announcements -->
	</div> <!-- .row -->
	<div class="row">
	<div id="events" class="col-md-6">
		<h1 class="sub_title text-center">Events <small><a name="events" title="A link to this section" href="#events">&sect;</a></small></h1>
		<div class="text-center"><a class="toggle_div">show/hide</a></div>
		<div id="events_body" class="toggleable">
		<hr style="width: 75%;" />
		</div> <!-- #events_body -->
	</div> <!-- #events -->
	<br class="visible-xs visible-sm" />
	<div id="misc" class="col-md-6">
		<h1 class="sub_title text-center">Miscellaneous <small><a name="miscellaneous" title="A link to this section" href="#miscellaneous">&sect;</a></small></h1>
		<div class="text-center"><a class="toggle_div">show/hide</a></div>
		<div class="misc_body" class="toggleable">
		<hr style="width: 75%;" />
		</div> <!-- #misc_body -->
	</div> <!-- #misc -->
	</div> <!-- .row -->
{% endif %}
{% endblock %}

{% block endscripts %}
<script>
$(document).ready(function() {
	var wi = $(window).width();
	if (wi <= 768 && $('a.toggle_div').parent().next('div.toggleable')) {
		$('a.toggle_div').show();
		$('a.toggle_div').parent().next('div.toggleable').hide();
	} else {
		$('a.toggle_div').parent().next('div').show();
		$('a.toggle_div').parent().next('div').addClass('toggleable');
		$('a.toggle_div').hide();
	}
	$(window).resize(function() {
		var wi = $(window).width();
		if (wi <= 768 && $('a.toggle_div').next('div.toggleable')) {
			$('a.toggle_div').show();
			$('a.toggle_div').parent().next('div.toggleable').hide();
		} else {
			$('a.toggle_div').parent().next('div').show();
			$('a.toggle_div').parent().next('div').addClass('toggleable');
			$('a.toggle_div').hide();
		}
	});
	$('a.toggle_div').click(function() {
		$(this).parent().next('div').toggle();
		$(this).parent().next('div').toggleClass('toggleable');
	});
});
</script>
{% endblock %}
