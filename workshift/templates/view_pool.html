{% extends "w_base.html" %}

{% load static from staticfiles %}
{% load request_tags %}
{% load bootstrap %}
{% load workshift_tags %}

{% block w_content %}
<div class="pool_container">
  {% if WORKSHIFT_MANAGER %}
  <form action="{% wurl 'workshift:edit_pool' pk=pool.pk sem_url=SEMESTER.sem_url %}" class="pull-right">
	<button class="btn btn-default" type="submit">
	  <span class="glyphicon glyphicon-edit"></span><span class="hidden-xs"> Edit Pool</span>
	</button>
  </form>
  <form action="{% wurl 'workshift:add_shift' sem_url=SEMESTER.sem_url %}" class="pull-right" style="margin-right: 5px;">
	<button class="btn btn-default" type="submit">
	  <span class="glyphicon glyphicon-plus"></span><span class="hidden-xs"> Add Shift</span>
	</button>
  </form>
  {% endif %}
  <h1 class="w_title">{{ page_name }}</h1>
  {% if pool.managers.count %}
  <p>Managers:
  {% for pos in pool.managers.all %}
  {% if not forloop.first %}, {% endif %}
  <a {% if pos.active %}title="View Details" href="{% url 'view_manager' managerTitle=pos.url_title %}"{% else %}title="This position is not active. Click to edit." class="text-muted" href="{% url 'edit_manager' managerTitle=pos.url_title %}"{% endif %}><span class="glyphicon glyphicon-tower"></span> {{ pos.title }}</a>
  {% if pos.incumbent %}
  (<a title="View Profile" href="{% url 'member_profile' targetUsername=pos.incumbent.user.username %}">{{ pos.incumbent }}</a>)
  {% else %}
  <span title="There is currently no incumbent for this position." class="text-danger">(No incumbent)</span>
  {% endif %}
  {% endfor %}
  </p>
  {% endif %}
  <p>{{ pool.show_hours }}</p>
  {% if pool.first_fine_date %}
  <p>{{ pool.first_fine_date }}</p>
  {% endif %}
  {% if pool.second_fine_date %}
  <p>{{ pool.second_fine_date }}</p>
  {% endif %}
  {% if pool.third_fine_date %}
  <p>{{ pool.third_fine_date }}</p>
  {% endif %}
  {% if shifts %}
  <h4>Regular Workshifts</h4>
  <table class="table table-striped table-bordered table-condensed table-hover">
	<thead>
	  <tr>
		<th>Title</th>
		<th>Time</th>
		<th>Hours</th>
		<th>Workshifter</th>
	  </tr>
	</thead>
	<tbody>
	  {% for shift in shifts %}
	  <tr>
		<td><a href="{% wurl 'workshift:view_shift' sem_url=SEMESTER.sem_url pk=shift.pk %}">{{ shift.title }}</td>
		<td>
		  {% if shift.week_long %}
		  Week long
		  {% else %}
		  {{ shift.get_day_display }}
		  {% endif %}
		  {{ shift.start_time }}
		  {% if shift.start_time and shift.end_time %} - {% endif %}
		  {{ shift.end_time }}
		<td>{{ shift.hours }}</td>
		<td>
		  {% if shift.current_assignee %}
		  {% for assignee in shift.current_assignees.all %}{% if not forloop.first %}, {% endif %}<a href="{% wurl 'workshift:profile' sem_url=SEMESTER.sem_url targetUsername=shift.current_assignee.user.username %}">{{ shift.current_assignee.user.get_full_name }}</a>{% endfor %}
		  {% endif %}
		</td>
	  </tr>
	  {% endfor %}
	</tbody>
  </table>
  {% endif %}
</div> <!-- .instance_container -->
{% endblock %}
